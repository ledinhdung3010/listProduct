(self.miniJsonp=self.miniJsonp||[]).push([[4997],{78232:function(e,r,t){var o;o=(e,r,t,o,n)=>(()=>{"use strict";var c={383:r=>{r.exports=e},975:e=>{e.exports=r},511:e=>{e.exports=t},644:e=>{e.exports=o},855:e=>{e.exports=n}},s={};function a(e){var r=s[e];if(void 0!==r)return r.exports;var t=s[e]={exports:{}};return c[e](t,t.exports,a),t.exports}a.d=(e,r)=>{for(var t in r)a.o(r,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},a.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{a.r(i),a.d(i,{allConversationIdsSelector:()=>s,conversationBeenDeletedSelector:()=>J,conversationDirectionSelector:()=>f,conversationHttpStatusSelector:()=>g,conversationIdsSelector:()=>n,conversationLastMessageSelector:()=>Ee,conversationsSelector:()=>m,curConvsMessageSelector:()=>ze,curMessagesRelatedSelector:()=>Me,currentBuyerIdSelector:()=>I,currentBuyerSelector:()=>L,currentBuyerShopIdSelector:()=>N,currentBuyerShopSelector:()=>U,currentConversationBuyerIdSelectors:()=>j,currentConversationCanReadSelector:()=>p,currentConversationIdSelector:()=>S,currentConversationMaxOptionHideTimeSelectors:()=>D,currentConversationSelector:()=>E,currentConversationShopIdSelectors:()=>A,currentConversationShopRegionSelectors:()=>T,currentConversationShopSelectors:()=>P,currentConversationStatusSelectors:()=>w,currentConversationToNameSelector:()=>K,currentConversationTranslationAccessSelector:()=>Y,currentPendingOffersCountSelector:()=>$,currentSellerAccountIdSelector:()=>te,currentShopIdSelector:()=>B,degradeConversationIdsSelector:()=>y,feedbackSelector:()=>Ue,filterSelector:()=>O,filteredConversationsSelector:()=>M,getConversation:()=>k,getConversationPendingOffersCountSelector:()=>ee,getConversationShopId:()=>z,getConversationShopRegion:()=>re,getConversations:()=>x,getConvsMessagesRelatedSelector:()=>be,getMessageSelector:()=>Oe,inlocationSelector:()=>d,isNavigateToUnreadMessageSelector:()=>W,keywordSelector:()=>G,listsHashSelector:()=>H,mediaListSelector:()=>Ne,messagesRelatedMapSelector:()=>he,missedReadNoticeCountSelector:()=>u,navigateToUnreadMessageIdSelector:()=>X,noticesCountSelector:()=>Ve,pinnedConversationIdsSelector:()=>c,readRequestIdsSelector:()=>l,reconnectFlagSelector:()=>Ge,replyToMessageSelector:()=>Le,resultsSelector:()=>V,reverseMessagesSelector:()=>je,searchConversationHttpStatusSelector:()=>F,selectVideoInfoByKey:()=>Re,selectVideoInfoKeyByVid:()=>ye,shopAccessSelector:()=>Q,singleConversationMarkInfoSelector:()=>se,sortedConversationsSelector:()=>b,totalConversationsCountSelector:()=>ne,updateTimeNowSelector:()=>v});var e=a(383),r=a(975),t=a(511),o=a(644),n=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.conversationIds)||[]},c=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.pinnedConversationIds)||[]},s=(0,r.createSelector)(n,c,((e,r)=>{var t=e.filter((e=>!r.includes(e)));return r.concat(t)})),l=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.readRequestIds)||[]},u=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.missedReadNoticeCount)||0},d=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.inlocation)||!1},v=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.updateTimeNow)||"0"},S=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.currentConversationId)||null},p=e=>{var r;return(0,t.judgeUndefined)({defaultValue:!0,value:null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.currentConversationCanRead})},g=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.status)||""},f=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.direction)||""},m=(0,r.createSelector)(t.conversationEntitiesSelector,s,((r,t)=>((0,e.denormalize)(t,[o.conversationSchema],{conversations:r})||[]).filter(Boolean))),_=(0,r.createSelector)(m,S,((e,r)=>e.filter((e=>{var{id:t,unread_count:o}=e;return e&&(o>0||t===r)})))),h=(0,r.createSelector)(m,(e=>e.filter((e=>e.isPinned)))),C=(0,r.createSelector)(m,(e=>e.filter((e=>e.status&&"closed"===e.status)))),R=(0,r.createSelector)(m,S,((e,r)=>e.filter((e=>{var{unreplied:t,id:o}=e;return void 0===t||t||!t&&o===r})))),y=(0,r.createSelector)(m,(e=>e.filter((e=>e.lack)).map((e=>e.id))||[])),O=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.filter)||"All"},M=(0,r.createSelector)(O,m,_,h,C,R,((e,r,t,o,n,c)=>({All:r,Unread:t,Pinned:o,Closed:n,Unreplied:c}[e]))),b=(0,r.createSelector)(M,c,t.waitingTimeFilterSelector,O,((e,r,t,o)=>{var n=e.filter((e=>!r.includes(e.id))),c=e.filter((e=>r.includes(e.id)));return n.sort(((e,r)=>parseInt(r.latest_message_id)-parseInt(e.latest_message_id))),c.concat(n).filter((e=>void 0===e.faking))})),E=(0,r.createSelector)(m,S,t.isSubAccountSelector,d,t.userEntitiesSelector,t.conversationEntitiesSelector,((r,t,n,c,s,a)=>{var i=r.find((e=>e.id===t))||{};if(c&&!i.id&&(i=(0,e.denormalize)(t,o.conversationSchema,{conversations:a})||{}),!n&&i.lack){var l=i.to_id,u=(0,e.denormalize)(l,o.userSchema,{users:s})||{},d={to_shop_id:u.shop_id,to_status:u.status,to_name:u.name||"-",to_avatar:u.avatar};return Object.assign(i,d)}return i})),I=(0,r.createSelector)(E,(e=>{var{to_id:r}=e||{};return r||null})),P=(0,r.createSelector)(E,t.shopsEntitiesSelector,((r,t)=>(0,e.denormalize)(r.shop_id,o.shopSchema,{shops:t})||{})),T=(0,r.createSelector)(P,(e=>(null==e?void 0:e.country)||"SG")),A=(0,r.createSelector)(E,(e=>e.shop_id)),j=(0,r.createSelector)(E,(e=>e.to_id)),w=(0,r.createSelector)(E,(e=>e.status)),D=(0,r.createSelector)(E,(e=>e.max_general_option_hide_time)),k=n=>(0,r.createSelector)(t.conversationEntitiesSelector,(r=>(0,e.denormalize)(n,o.conversationSchema,{conversations:r})||{})),z=e=>(0,r.createSelector)(k(e),(e=>e.shop_id)),x=e=>(0,r.createSelector)(m,(r=>e.map((e=>r.find((r=>r.id===e)))).filter(Boolean))),B=(0,r.createSelector)(E,(e=>{var{shop_id:r}=e||{};return r||null})),L=(0,r.createSelector)(t.userEntitiesSelector,E,((r,t)=>t?(0,e.denormalize)(t.to_id,o.userSchema,{users:r}):{})),N=(0,r.createSelector)(E,(e=>{var{to_shop_id:r}=e||{};return r||null})),U=(0,r.createSelector)(N,t.shopsEntitiesSelector,((r,t)=>(0,e.denormalize)(r,o.shopSchema,{shops:t})||{})),G=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.keyword)||""},V=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.results)||[]},F=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.searchStatus)||""},Y=(0,r.createSelector)(E,(e=>e.translationAccess)),H=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.listsHash)||{}},J=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.conversationBeenDeleted)||!1},K=(0,r.createSelector)(E,(e=>{var{to_name:r}=e||{};return r})),q={hasSCAccess:!0,hasEditOrderAccess:!0,hasViewOrderAccess:!0,hasViewProductAccess:!0,hasEditVoucherAccess:!0,hasViewVoucherAccess:!0,hasViewRrOrderAccess:!0,hasOrderDetailAccess:!0},Q=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.access)||q},W=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.isNavigateToUnreadMessage)||!1},X=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.navigateToUnreadMessageId)||""},Z=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.pendingOffersCount)||{}},$=(0,r.createSelector)(E,Z,((e,r)=>{var{shop_id:t,to_id:o}=e;return r["".concat(t,"_").concat(o)]||0})),ee=e=>(0,r.createSelector)(k(e),Z,((e,r)=>{var{shop_id:t,to_id:o}=e;return r["".concat(t,"_").concat(o)]||0})),re=n=>(0,r.createSelector)(z(n),t.shopsEntitiesSelector,((r,t)=>{var n=(0,e.denormalize)(r,o.shopSchema,{shops:t})||{};return(null==n?void 0:n.country)||"SG"})),te=(0,r.createSelector)(t.isSubAccountSelector,t.currentUserIdSelector,P,((e,r,t)=>e?t.user_id:r)),oe={unrepliedCount:0,duesoonCount:0,overdueCount:0,pinnedCount:0,unreadCount:0},ne=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.totalConversationsCount)||oe},ce=e=>{var r;return(null==e||null===(r=e.conversationReducer)||void 0===r?void 0:r.conversationMark)||{}},se=e=>(0,r.createSelector)(ce,(r=>r[e]));function ae(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var ie=a(855);function le(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function ue(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?le(Object(t),!0).forEach((function(r){ae(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):le(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var de,{MSG_TYPE_OFFER:ve,MSG_TYPE_ORDER:Se,MSG_TYPE_PRODUCT:pe,MSG_TYPE_FAQ_UNSUPPORTED:ge,MSG_TYPE_FAQ_LIVEAGENT_PROMPT:fe,MSG_TYPE_RATE_CARD:me}=ie.MessageTypes,_e=[Se,pe],he=(0,r.createSelector)((e=>e),(e=>(e.messageReducer||{}).messagesRelatedMap||{})),Ce=e=>{var r;return(null===(r=e.messageReducer)||void 0===r?void 0:r.videoMap)||{}},Re=e=>(0,r.createSelector)(Ce,(r=>JSON.parse(JSON.stringify(r[e]||{})))),ye=e=>(0,r.createSelector)(Ce,(r=>Object.keys(r).find((t=>r[t].vid===e)))),Oe=n=>(0,r.createSelector)(t.messageEntitiesSelector,(r=>(0,e.denormalize)(n,o.messageSchema,{messages:r}))),Me=(0,r.createSelector)(S,he,((e,r)=>r[e]||{all:[]})),be=e=>(0,r.createSelector)(he,(r=>r[e]||{all:[],sending:[],failed:[]})),Ee=(de=e=>(0,r.createSelector)(be(e),k(e),t.messageEntitiesSelector,((e,r,o)=>(0,t.getConversationLastMessage)(e,r,o))),function(){var e=Array.prototype.slice.call(arguments);return e in(de.memoize=de.memoize||{})?de.memoize[e]:de.memoize[e]=de.apply(this,e)}),Ie=(0,r.createSelector)(Me,(e=>{var r=[...e.all||[]];return e.securityTipsMessageId&&r.push(e.securityTipsMessageId),r})),Pe=(0,r.createSelector)(Me,(e=>e.sending||[])),Te=(0,r.createSelector)(Me,(e=>e.failed||[])),Ae=(0,r.createSelector)(t.messageEntitiesSelector,Ie,((r,t)=>((0,e.denormalize)(t,[o.messageSchema],{messages:r})||[]).filter(Boolean))),je=(0,r.createSelector)(Ae,(e=>e.reverse())),we=(0,r.createSelector)(E,je,((e,r)=>e?r.filter(Boolean).reduce(((e,r)=>{var{type:t,source_type:o,source_content:n,content:c}=r;if(!o||t===ve||[-1,0].includes(n["".concat(o,"_id")]))return e;if(_e.includes(t)&&n){var s="".concat(t,"_id");if(c[s]===n[s])return e}var{lastSourceMessage:a,sourceList:i}=e;if(!i.length)return{sourceList:i.concat(r),lastSourceMessage:r};if(o===pe){var l=null==n?void 0:n.product_id,u=a.source_content&&a.source_content.product_id;if(!l||u===l)return e}else if(o===Se){var d=null==n?void 0:n.order_id,v=a.source_content&&a.source_content.order_id;if(!d||[-1,0,v].includes(d))return e}return{sourceList:i.concat(r),lastSourceMessage:r}}),{sourceList:[],lastSourceMessage:null}).sourceList:[])),De=(0,r.createSelector)(we,(e=>e.map((e=>e.id)))),ke=(0,r.createSelector)(t.entitiesSelector,Ae,((r,t)=>{var n=t.filter((e=>e&&e.type===ve)).map((e=>e.content.offer_id));return(0,e.denormalize)(n,[o.offerSchema],r)})),ze=(0,r.createSelector)(je,De,Pe,Te,E,t.rateCardEntitiesSelector,ke,((e,r,t,o,n,c,s)=>n?e.filter((e=>{if(!e)return!1;var{content:r,type:t}=e;return!(![ge,fe].includes(t)&&(!r||r&&0===Object.keys(r).length))})).map((e=>{var n=t.includes(e.id)?ie.MessageSendStatus.SENDING:o.includes(e.id)?ie.MessageSendStatus.FAILED:e.send_status?ie.MessageSendStatus.SUCCEED:null,a=r.includes(e.id),i=Object.assign({},e,{send_status:n,hasMessageSource:a}),{type:l,content:u={},message_option:d}=i;switch(l){case ve:var v=s.find((e=>e&&e.id===u.offer_id));i=Object.assign({},i,{textContent:v});break;case me:var S=c[u.card_id];S&&(i=Object.assign({},i,{textContent:S}))}return(0,ie.hasTargetMessageOption)(d,ie.MessageOption.MSG_OPT_CENSORED_BLACKLIST)&&(i=ue(ue({},i),{},{send_status:ie.MessageSendStatus.FAILED,errorCode:ie.MessageErrorCode.BLACKLIST})),i})):[])),xe=(0,r.createSelector)((e=>{var r;return null==e||null===(r=e.messageReducer)||void 0===r?void 0:r.reply}),(e=>e?e.toMessageId:{})),Be=(0,r.createSelector)(S,xe,((e,r)=>r[e]||"")),Le=(0,r.createSelector)(Be,t.messageEntitiesSelector,((r,t)=>(0,e.denormalize)(r,o.messageSchema,{messages:t}))),Ne=(0,r.createSelector)(S,(e=>{var r;return(null===(r=e.mediaPreviewerReducer)||void 0===r?void 0:r.mediaMap)||{}}),((e,r)=>r[e]||[])),Ue=e=>{var r;return(null==e||null===(r=e.socketReducer)||void 0===r?void 0:r.feedback)||void 0},Ge=e=>{var r;return(null==e||null===(r=e.socketReducer)||void 0===r?void 0:r.reconnectFlag)||!1},Ve=e=>{var r;return(null==e||null===(r=e.socketReducer)||void 0===r?void 0:r.noticesCount)||0}})(),i})(),e.exports=o(t(82677),t(20573),t(53402),t(96961),t(29494))},66633:function(e,r,t){"use strict";e.exports=t(78232)}}]);